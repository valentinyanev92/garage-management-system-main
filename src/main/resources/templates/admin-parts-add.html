<!DOCTYPE html>
<html lang="bg" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Part - Admin Panel</title>
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
    <link rel="stylesheet" th:href="@{/css/dashboard-form.css}">
    <style>
        .profile-edit-button.green {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
            animation: none;
        }
        .profile-edit-button.green:hover {
            background: linear-gradient(135deg, #20c997 0%, #28a745 100%);
            box-shadow: 0 8px 24px rgba(40, 167, 69, 0.5);
        }
    </style>
</head>
<body>
<div class="dashboard-wrapper">
    <aside class="sidebar">
        <nav class="sidebar-nav">
            <a href="/dashboard" class="nav-button">
                <span>Dashboard</span>
            </a>
            <a href="/profile/edit" class="nav-button">
                <span>Edit Profile</span>
            </a>
            <a th:href="@{/cars}" class="nav-button">
                <span>Manage Cars</span>
            </a>
            <a th:href="@{/orders}" class="nav-button">
                <span>Manage Orders</span>
            </a>
            <div class="nav-spacer"></div>
            <div class="nav-bottom-section">
                <a th:href="@{/dashboard/mechanic}"
                   class="nav-button mechanic-button"
                   th:if="${user.role.name().equals('MECHANIC') or user.role.name().equals('ADMIN')}">
                    <span>Mechanic Panel</span>
                </a>
                <a th:href="@{/dashboard/admin}"
                   class="nav-button admin-button active">
                    <span>Admin Panel</span>
                </a>
                <a th:href="@{/logout}" class="nav-button logout-button">
                    <span>Logout</span>
                </a>
            </div>
        </nav>
    </aside>

    <div class="dashboard-container">
        <header class="dashboard-header">
            <h1 class="dashboard-title">Add Part</h1>
        </header>

        <main class="dashboard-content" style="align-items: center;">
            <div class="profile-edit-container">
                <div class="profile-edit-form">
                    <form th:action="@{/dashboard/admin/parts/add}" th:object="${partAddRequest}" method="post">
                        <div class="form-group">
                            <label for="name">Part Name</label>
                            <div class="help-text" th:classappend="${#fields.hasErrors('name')} ? 'show-help' : ''">
                                Part name is required
                            </div>
                            <input type="text" id="name" th:field="*{name}" placeholder="Enter part name" required>
                            <div th:if="${#fields.hasErrors('name')}" class="error-message" th:errors="*{name}"></div>
                        </div>

                        <div class="form-group">
                            <label for="manufacturer">Manufacturer</label>
                            <div class="help-text"
                                 th:classappend="${#fields.hasErrors('manufacturer')} ? 'show-help' : ''">
                                Manufacturer is required
                            </div>
                            <input type="text" id="manufacturer" th:field="*{manufacturer}"
                                   placeholder="Enter manufacturer name" required>
                            <div th:if="${#fields.hasErrors('manufacturer')}" class="error-message"
                                 th:errors="*{manufacturer}"></div>
                        </div>

                        <div class="form-group">
                            <label for="price">Price</label>
                            <div class="help-text" th:classappend="${#fields.hasErrors('price')} ? 'show-help' : ''">
                                Price must be greater than 0
                            </div>
                            <input type="number" id="price" th:field="*{price}" step="0.01" min="0.01"
                                   placeholder="Enter price in BGN" required>
                            <div th:if="${#fields.hasErrors('price')}" class="error-message" th:errors="*{price}"></div>
                        </div>

                        <button type="button" class="profile-edit-button green" style="margin-bottom: 10px;"
                                onclick="fillExamplePartData()">
                            Use example data
                        </button>
                        <button type="submit" class="profile-edit-button">Add Part</button>
                    </form>
                    <div class="profile-edit-links">
                        <a th:href="@{/dashboard/admin/parts}" class="back-link">Back to Parts</a>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<div th:replace="fragments/footer :: footer"></div>
<script>
    (function () {
        const partNames = [
            'Oil Filter', 'Air Filter', 'Brake Pad Set', 'Spark Plug', 'Timing Belt',
            'Fuel Pump', 'Alternator', 'Radiator Hose', 'Wiper Blade', 'Clutch Kit',
            'Water Pump', 'Thermostat', 'Ignition Coil', 'Engine Mount', 'Shock Absorber'
        ];
        const manufacturers = [
            'Bosch', 'Valeo', 'Denso', 'NGK', 'ContiTech', 'SKF',
            'Magneti Marelli', 'Delphi', 'Mann+Hummel', 'Hella'
        ];

        function randomItem(arr) { return arr[Math.floor(Math.random() * arr.length)]; }

        function randomPrice(min, max) {
            const value = Math.random() * (max - min) + min;
            return (Math.round(value * 100) / 100).toFixed(2);
        }

        window.fillExamplePartData = function () {
            const nameInput = document.getElementById('name');
            const manufacturerInput = document.getElementById('manufacturer');
            const priceInput = document.getElementById('price');

            // Add a small random suffix to avoid duplicate names
            const suffix = Math.floor(Math.random() * 900 + 100);
            if (nameInput) nameInput.value = `${randomItem(partNames)} ${suffix}`;
            if (manufacturerInput) manufacturerInput.value = randomItem(manufacturers);
            if (priceInput) priceInput.value = randomPrice(10, 500);

            if (nameInput) nameInput.focus();
        };
    })();
</script>
</body>
</html>

